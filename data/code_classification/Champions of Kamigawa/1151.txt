public class KusariGama extends CardImpl {°Ïpublic KusariGama(UUID ownerId) {°Ïsuper(ownerId, 260, "Kusari-Gama", Rarity.RARE, new CardType[]{CardType.ARTIFACT}, "{3}");°Ïthis.expansionSetCode = "CHK";°Ïthis.subtype.add("Equipment");°ÏAbility gainedAbility = new SimpleActivatedAbility(Zone.BATTLEFIELD, new BoostSourceEffect(1,0, Duration.EndOfTurn), new GenericManaCost(2));°ÏEffect effect = new GainAbilityAttachedEffect(gainedAbility, AttachmentType.EQUIPMENT);°Ïeffect.setText("Equipped creature has \"{2}: This creature gets +1/+0 until end of turn.\"");°ÏAbility ability = new SimpleStaticAbility(Zone.BATTLEFIELD, effect);°Ïthis.addAbility(ability);°Ïthis.addAbility(new KusariGamaAbility());°Ïthis.addAbility(new EquipAbility(Outcome.AddAbility, new GenericManaCost(3)));°Ï}°Ïpublic KusariGama(final KusariGama card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic KusariGama copy() {°Ïreturn new KusariGama(this);°Ï}°Ï}°Ïclass KusariGamaAbility extends TriggeredAbilityImpl {°Ïprivate static final FilterCreaturePermanent filter = new FilterBlockingCreature();°Ïpublic KusariGamaAbility() {°Ïsuper(Zone.BATTLEFIELD, new KusariGamaDamageEffect());°Ï}°Ïpublic KusariGamaAbility(final KusariGamaAbility ability) {°Ïsuper(ability);°Ï}°Ï@Override°Ïpublic KusariGamaAbility copy() {°Ïreturn new KusariGamaAbility(this);°Ï}°Ï@Override°Ïpublic boolean checkEventType(GameEvent event, Game game) {°Ïreturn event.getType() == EventType.DAMAGED_CREATURE;°Ï}°Ï@Override°Ïpublic boolean checkTrigger(GameEvent event, Game game) {°ÏPermanent sourcePermanet = game.getPermanent(event.getSourceId());°ÏPermanent targetPermanet = game.getPermanent(event.getTargetId());°Ïif (sourcePermanet != null && targetPermanet != null && sourcePermanet.getAttachments().contains(this.getSourceId()) && filter.match(targetPermanet, game)) {°Ïthis.getEffects().get(0).setValue("damageAmount", event.getAmount());°Ïthis.getEffects().get(0).setValue("damagedCreatureId", targetPermanet.getId());°Ïreturn true;°Ï}°Ïreturn false;°Ï}°Ï@Override°Ïpublic String getRule() {°Ïreturn "Whenever equipped creature deals damage to a blocking creature, {this} deals that much damage to each other creature defending player controls.";°Ï}°Ï}°Ïclass KusariGamaDamageEffect extends OneShotEffect {°Ïpublic KusariGamaDamageEffect() {°Ïsuper(Outcome.Damage);°Ïthis.staticText = "{this} deals that much damage to each other creature defending player controls";°Ï}°Ïpublic KusariGamaDamageEffect(final KusariGamaDamageEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic KusariGamaDamageEffect copy() {°Ïreturn new KusariGamaDamageEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°ÏInteger damage = (Integer) this.getValue("damageAmount");°Ïif (damage != null && damage.intValue() > 0) {°ÏUUID damagedCreatureId = (UUID) this.getValue("damagedCreatureId");°ÏPermanent creature = game.getPermanent(damagedCreatureId);°Ïif (creature == null) {°Ïcreature = (Permanent) game.getLastKnownInformation(damagedCreatureId, Zone.BATTLEFIELD);°Ï}°Ïif (creature != null) {°Ïfor (UUID blockerId : game.getCombat().getBlockers()) {°Ïif (!blockerId.equals(damagedCreatureId)) {°ÏPermanent blockingCreature = game.getPermanent(blockerId);°Ïif (blockingCreature != null && blockingCreature.getControllerId().equals(creature.getControllerId())) {°ÏblockingCreature.damage(damage, source.getSourceId(), game, false, true);°Ï}°Ï}°Ï}°Ï}°Ï}°Ïreturn false;°Ï}°Ï}°Ï
