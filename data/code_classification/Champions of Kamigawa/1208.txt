public class Reweave extends CardImpl {¡ìpublic Reweave(UUID ownerId) {¡ìsuper(ownerId, 82, "Reweave", Rarity.RARE, new CardType[]{CardType.INSTANT}, "{5}{U}");¡ìthis.expansionSetCode = "CHK";¡ìthis.subtype.add("Arcane");¡ìthis.getSpellAbility().addEffect(new ReweaveEffect());¡ìTarget target = new TargetPermanent();¡ìthis.getSpellAbility().addTarget(target);¡ìthis.addAbility(new SpliceOntoArcaneAbility("{2}{U}{U}"));¡ì}¡ìpublic Reweave(final Reweave card) {¡ìsuper(card);¡ì}¡ì@Override¡ìpublic Reweave copy() {¡ìreturn new Reweave(this);¡ì}¡ì}¡ìclass ReweaveEffect extends OneShotEffect {¡ìprivate static final FilterPermanentCard filter = new FilterPermanentCard();¡ìpublic ReweaveEffect() {¡ìsuper(Outcome.Detriment);¡ìthis.staticText = "Target permanent's controller sacrifices it. If he or she does, that player reveals cards from the top of his or her library until he or she reveals a permanent card that shares a card type with the sacrificed permanent, puts that card onto the battlefield, then shuffles his or her library";¡ì}¡ìpublic ReweaveEffect(final ReweaveEffect effect) {¡ìsuper(effect);¡ì}¡ì@Override¡ìpublic ReweaveEffect copy() {¡ìreturn new ReweaveEffect(this);¡ì}¡ì@Override¡ìpublic boolean apply(Game game, Ability source) {¡ìPermanent permanent = game.getPermanent(getTargetPointer().getFirst(game, source));¡ìMageObject sourceObject = source.getSourceObject(game);¡ìif (permanent != null && sourceObject != null) {¡ìif (permanent.sacrifice(source.getSourceId(), game)) {¡ìPlayer permanentController = game.getPlayer(permanent.getControllerId());¡ìif (permanentController != null) {¡ìLibrary library = permanentController.getLibrary();¡ìif (library.size() > 0) {¡ìCards cards = new CardsImpl();¡ìCard card = null;¡ìboolean cardFound = false;¡ìif (library.size() > 0) {¡ìdo {¡ìcard = library.removeFromTop(game);¡ìcards.add(card);¡ìif (filter.match(card, game)) {¡ìfor (CardType cardType : permanent.getCardType()) {¡ìif (card.getCardType().contains(cardType)) {¡ìcardFound = true;¡ìbreak;¡ì}¡ì}¡ì}¡ì} while (!cardFound && library.size() > 0);¡ìpermanentController.moveCards(card, Zone.BATTLEFIELD, source, game);¡ì}¡ìif (cards.size() > 0) {¡ìpermanentController.revealCards(sourceObject.getIdName(), cards, game);¡ìif (cardFound && card != null) {¡ìcards.remove(card);¡ì}¡ìlibrary.addAll(cards.getCards(game), game);¡ìpermanentController.shuffleLibrary(game);¡ì}¡ì}¡ìreturn true;¡ì}¡ìreturn false;¡ì}¡ì}¡ìreturn true;¡ì}¡ì}¡ì
