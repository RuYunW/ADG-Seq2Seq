public class DiluvianPrimordial extends CardImpl {°Ïpublic DiluvianPrimordial(UUID ownerId) {°Ïsuper(ownerId, 33, "Diluvian Primordial", Rarity.RARE, new CardType[]{CardType.CREATURE}, "{5}{U}{U}");°Ïthis.expansionSetCode = "GTC";°Ïthis.subtype.add("Avatar");°Ïthis.power = new MageInt(5);°Ïthis.toughness = new MageInt(5);°Ïthis.addAbility(FlyingAbility.getInstance());°Ïthis.addAbility(new EntersBattlefieldTriggeredAbility(new DiluvianPrimordialEffect(), false));°Ï}°Ï@Override°Ïpublic void adjustTargets(Ability ability, Game game) {°Ïif (ability instanceof EntersBattlefieldTriggeredAbility) {°Ïability.getTargets().clear();°Ïfor (UUID opponentId : game.getOpponents(ability.getControllerId())) {°ÏPlayer opponent = game.getPlayer(opponentId);°Ïif (opponent != null) {°ÏFilterCard filter = new FilterCard("instant or sorcery card from " + opponent.getLogName() + "'s graveyard");°Ïfilter.add(new OwnerIdPredicate(opponentId));°Ïfilter.add(Predicates.or(new CardTypePredicate(CardType.INSTANT), new CardTypePredicate(CardType.SORCERY)));°ÏTargetCardInOpponentsGraveyard target = new TargetCardInOpponentsGraveyard(0, 1, filter);°Ïability.addTarget(target);°Ï}°Ï}°Ï}°Ï}°Ïpublic DiluvianPrimordial(final DiluvianPrimordial card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic DiluvianPrimordial copy() {°Ïreturn new DiluvianPrimordial(this);°Ï}°Ï}°Ïclass DiluvianPrimordialEffect extends OneShotEffect {°Ïpublic DiluvianPrimordialEffect() {°Ïsuper(Outcome.PlayForFree);°Ïthis.staticText = "for each opponent, you may cast up to one target instant or sorcery card from that player's graveyard without paying its mana cost. If a card cast this way would be put into a graveyard this turn, exile it instead";°Ï}°Ïpublic DiluvianPrimordialEffect(final DiluvianPrimordialEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic DiluvianPrimordialEffect copy() {°Ïreturn new DiluvianPrimordialEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°ÏPlayer controller = game.getPlayer(source.getControllerId());°Ïif (controller != null) {°Ïfor (Target target : source.getTargets()) {°Ïif (target instanceof TargetCardInOpponentsGraveyard) {°ÏCard targetCard = game.getCard(target.getFirstTarget());°Ïif (targetCard != null) {°Ïif (controller.chooseUse(outcome, "Cast " + targetCard.getLogName() + "?", source, game)) {°Ïif (controller.cast(targetCard.getSpellAbility(), game, true)) {°ÏContinuousEffect effect = new DiluvianPrimordialReplacementEffect();°Ïeffect.setTargetPointer(new FixedTarget(targetCard.getId(), game.getState().getZoneChangeCounter(targetCard.getId())));°Ïgame.addEffect(effect, source);°Ï}°Ï}°Ï}°Ï}°Ï}°Ïreturn true;°Ï}°Ïreturn false;°Ï}°Ï}°Ïclass DiluvianPrimordialReplacementEffect extends ReplacementEffectImpl {°Ïpublic DiluvianPrimordialReplacementEffect() {°Ïsuper(Duration.EndOfTurn, Outcome.Exile);°ÏstaticText = "If a card cast this way would be put into a graveyard this turn, exile it instead";°Ï}°Ïpublic DiluvianPrimordialReplacementEffect(final DiluvianPrimordialReplacementEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic DiluvianPrimordialReplacementEffect copy() {°Ïreturn new DiluvianPrimordialReplacementEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°Ïreturn true;°Ï}°Ï@Override°Ïpublic boolean replaceEvent(GameEvent event, Ability source, Game game) {°ÏPlayer controller = game.getPlayer(source.getControllerId());°Ïif (controller != null) {°ÏCard card = game.getCard(getTargetPointer().getFirst(game, source));°Ïif (card != null) {°Ïcontroller.moveCardToExileWithInfo(card, null, "", source.getSourceId(), game, Zone.STACK, true);°Ïreturn true;°Ï}°Ï}°Ïreturn false;°Ï}°Ï@Override°Ïpublic boolean checksEventType(GameEvent event, Game game) {°Ïreturn event.getType() == EventType.ZONE_CHANGE;°Ï}°Ï@Override°Ïpublic boolean applies(GameEvent event, Ability source, Game game) {°ÏZoneChangeEvent zEvent = (ZoneChangeEvent) event;°Ïreturn zEvent.getToZone() == Zone.GRAVEYARD°Ï&& ((ZoneChangeEvent) event).getTargetId().equals(getTargetPointer().getFirst(game, source));°Ï}°Ï}°Ï
