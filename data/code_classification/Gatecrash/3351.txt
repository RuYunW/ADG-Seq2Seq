public class DimirCharm extends CardImpl {°Ïprivate static final FilterCreaturePermanent filterCreature = new FilterCreaturePermanent("creature with power 2 or less");°Ïprivate static final FilterSpell filterSorcery = new FilterSpell("sorcery spell");°Ïstatic {°ÏfilterCreature.add(new PowerPredicate(Filter.ComparisonType.LessThan, 3));°ÏfilterSorcery.add(new CardTypePredicate(CardType.SORCERY));°Ï}°Ïpublic DimirCharm (UUID ownerId) {°Ïsuper(ownerId, 154, "Dimir Charm", Rarity.UNCOMMON, new CardType[]{CardType.INSTANT}, "{U}{B}");°Ïthis.expansionSetCode = "GTC";°Ïthis.getSpellAbility().addEffect(new CounterTargetEffect());°Ïthis.getSpellAbility().addTarget(new TargetSpell(filterSorcery));°ÏMode mode1 = new Mode();°Ïmode1.getEffects().add(new DestroyTargetEffect());°Ïmode1.getTargets().add(new TargetCreaturePermanent(filterCreature));°Ïthis.getSpellAbility().addMode(mode1);°ÏMode mode2 = new Mode();°Ïmode2.getEffects().add(new DimirCharmEffect());°Ïmode2.getTargets().add(new TargetPlayer());°Ïthis.getSpellAbility().addMode(mode2);°Ï}°Ïpublic DimirCharm(final DimirCharm card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic DimirCharm copy() {°Ïreturn new DimirCharm(this);°Ï}°Ï}°Ïclass DimirCharmEffect extends OneShotEffect {°Ïpublic DimirCharmEffect() {°Ïsuper(Outcome.Benefit);°Ï}°Ïpublic DimirCharmEffect(final DimirCharmEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°ÏPlayer player = game.getPlayer(source.getFirstTarget());°ÏPlayer controller = game.getPlayer(source.getControllerId());°Ïif(controller != null && player != null){°ÏCards cards = new CardsImpl();°Ïfor(int i = 0; i < 3; i++){°ÏCard card = player.getLibrary().removeFromTop(game);°Ïif(card != null){°Ïcards.add(card);°Ï}°Ï}°Ïif(cards.size() > 0){°ÏTargetCard target = new TargetCard(Zone.LIBRARY, new FilterCard("Card to put back on top of library"));°Ïif(controller.chooseTarget(Outcome.Benefit, cards, target, source, game)){°ÏCard card = cards.get(target.getFirstTarget(), game);°Ïif(card != null){°Ïcard.moveToZone(Zone.LIBRARY, source.getSourceId(), game, true);°Ïcards.remove(card);°Ï}°Ïcontroller.moveCards(cards, Zone.LIBRARY, Zone.GRAVEYARD, source, game);°Ï}°Ï}°Ï}°Ïreturn false;°Ï}°Ï@Override°Ïpublic DimirCharmEffect copy() {°Ïreturn new DimirCharmEffect(this);°Ï}°Ï@Override°Ïpublic String getText(Mode mode) {°Ïreturn "look at the top three cards of target player's library, then put one back and the rest into that player's graveyard";°Ï}°Ï}°Ï
