public class GruulCharm extends CardImpl {°Ïprivate static final FilterCreaturePermanent filter = new FilterCreaturePermanent("Creatures without flying");°Ïprivate static final FilterPermanent filter2 = new FilterPermanent("all permanents you own");°Ïprivate static final FilterCreaturePermanent filter3 = new FilterCreaturePermanent("creature with flying");°Ïstatic {°Ïfilter.add(Predicates.not(new AbilityPredicate(FlyingAbility.class)));°Ïfilter2.add(new OwnerPredicate(TargetController.YOU));°Ïfilter3.add(new AbilityPredicate(FlyingAbility.class));°Ï}°Ïpublic GruulCharm(UUID ownerId) {°Ïsuper(ownerId, 169, "Gruul Charm", Rarity.UNCOMMON, new CardType[]{CardType.INSTANT}, "{R}{G}");°Ïthis.expansionSetCode = "GTC";°Ïthis.getSpellAbility().addEffect(new CantBlockAllEffect(filter, Duration.EndOfTurn));°ÏMode mode = new Mode();°Ïmode.getEffects().add(new GainControlAllEffect(Duration.EndOfGame, filter2));°Ïthis.getSpellAbility().addMode(mode);°ÏMode mode2 = new Mode();°Ïmode2.getEffects().add(new DamageAllEffect(3, filter3));°Ïthis.getSpellAbility().addMode(mode2);°Ï}°Ïpublic GruulCharm(final GruulCharm card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic GruulCharm copy() {°Ïreturn new GruulCharm(this);°Ï}°Ï}°Ïclass GainControlAllEffect extends ContinuousEffectImpl {°Ïfinal FilterPermanent filter;°Ïpublic GainControlAllEffect(Duration duration, FilterPermanent filter) {°Ïsuper(duration, Layer.ControlChangingEffects_2, SubLayer.NA, Outcome.GainControl);°Ïthis.filter = filter;°Ï}°Ïpublic GainControlAllEffect(final GainControlAllEffect effect) {°Ïsuper(effect);°Ïthis.filter = effect.filter.copy();°Ï}°Ï@Override°Ïpublic GainControlAllEffect copy() {°Ïreturn new GainControlAllEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°Ïfor (Permanent permanent : game.getBattlefield().getActivePermanents(filter, source.getControllerId(), game)) {°Ïif (permanent != null) {°Ïpermanent.changeControllerId(source.getControllerId(), game);°Ï}°Ï}°Ïreturn true;°Ï}°Ï@Override°Ïpublic String getText(Mode mode) {°Ïreturn "Gain control of all permanents you own";°Ï}°Ï}°Ï
