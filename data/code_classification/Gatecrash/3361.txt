public class DyingWish extends CardImpl {°Ïpublic DyingWish(UUID ownerId) {°Ïsuper(ownerId, 64, "Dying Wish", Rarity.UNCOMMON, new CardType[]{CardType.ENCHANTMENT}, "{1}{B}");°Ïthis.expansionSetCode = "GTC";°Ïthis.subtype.add("Aura");°ÏTargetPermanent auraTarget = new TargetControlledCreaturePermanent();°Ïthis.getSpellAbility().addTarget(auraTarget);°Ïthis.getSpellAbility().addEffect(new AttachEffect(Outcome.Benefit));°ÏAbility ability = new EnchantAbility(auraTarget.getTargetName());°Ïthis.addAbility(ability);°ÏDynamicValue attachedPower = new DyingWishAttachedPermanentPowerCount();°Ïability = new DiesAttachedTriggeredAbility(new LoseLifeTargetEffect(attachedPower), "enchanted creature");°Ïability.addEffect(new GainLifeEffect(attachedPower));°Ïability.addTarget(new TargetPlayer());°Ïthis.addAbility(ability);°Ï}°Ïpublic DyingWish(final DyingWish card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic DyingWish copy() {°Ïreturn new DyingWish(this);°Ï}°Ï}°Ïclass DyingWishAttachedPermanentPowerCount implements DynamicValue {°Ï@Override°Ïpublic int calculate(Game game, Ability sourceAbility, Effect effect) {°ÏPermanent attachmentPermanent = game.getPermanent(sourceAbility.getSourceId());°Ïif (attachmentPermanent == null) {°ÏattachmentPermanent = (Permanent) game.getLastKnownInformation(sourceAbility.getSourceId(), Zone.BATTLEFIELD, sourceAbility.getSourceObjectZoneChangeCounter());°Ï}°Ïif (attachmentPermanent != null && attachmentPermanent.getAttachedTo() != null) {°Ïif (effect.getValue("attachedTo") != null) {°ÏPermanent attached = (Permanent) effect.getValue("attachedTo");°Ïif (attached != null) {°Ïreturn attached.getPower().getValue();°Ï}°Ï}°Ï}°Ïreturn 0;°Ï}°Ï@Override°Ïpublic DynamicValue copy() {°Ïreturn new DyingWishAttachedPermanentPowerCount();°Ï}°Ï@Override°Ïpublic String toString() {°Ïreturn "X";°Ï}°Ï@Override°Ïpublic String getMessage() {°Ïreturn "its power";°Ï}°Ï}°Ï
