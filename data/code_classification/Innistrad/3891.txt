public class GhostlyPossession extends CardImpl {°Ïpublic GhostlyPossession(UUID ownerId) {°Ïsuper(ownerId, 18, "Ghostly Possession", Rarity.COMMON, new CardType[]{CardType.ENCHANTMENT}, "{2}{W}");°Ïthis.expansionSetCode = "ISD";°Ïthis.subtype.add("Aura");°ÏTargetPermanent auraTarget = new TargetCreaturePermanent();°Ïthis.getSpellAbility().addTarget(auraTarget);°Ïthis.getSpellAbility().addEffect(new AttachEffect(Outcome.AddAbility));°ÏAbility ability = new EnchantAbility(auraTarget.getTargetName());°Ïthis.addAbility(ability);°Ïthis.addAbility(new SimpleStaticAbility(Zone.BATTLEFIELD, new GainAbilityAttachedEffect(FlyingAbility.getInstance(), AttachmentType.AURA)));°Ïthis.addAbility(new SimpleStaticAbility(Zone.BATTLEFIELD, new GhostlyPossessionEffect()));°Ï}°Ïpublic GhostlyPossession(final GhostlyPossession card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic GhostlyPossession copy() {°Ïreturn new GhostlyPossession(this);°Ï}°Ï}°Ïclass GhostlyPossessionEffect extends PreventionEffectImpl {°Ïpublic GhostlyPossessionEffect() {°Ïsuper(Duration.WhileOnBattlefield, Integer.MAX_VALUE, true);°ÏstaticText = "Prevent all combat damage that would be dealt to and dealt by enchanted creature";°Ï}°Ïpublic GhostlyPossessionEffect(final GhostlyPossessionEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic GhostlyPossessionEffect copy() {°Ïreturn new GhostlyPossessionEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°Ïreturn true;°Ï}°Ï@Override°Ïpublic boolean applies(GameEvent event, Ability source, Game game) {°Ïif (super.applies(event, source, game) && event instanceof DamageEvent) {°ÏDamageEvent damageEvent = (DamageEvent) event;°Ïif (damageEvent.isCombatDamage()) {°ÏPermanent aura = game.getPermanent(source.getSourceId());°Ïif (aura != null && aura.getAttachedTo() != null) {°Ïif (event.getSourceId().equals(aura.getAttachedTo()) || event.getTargetId().equals(aura.getAttachedTo())) {°Ïreturn true;°Ï}°Ï}°Ï}°Ï}°Ïreturn false;°Ï}°Ï}°Ï
