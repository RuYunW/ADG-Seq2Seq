public class GrimoireOfTheDead extends CardImpl {°Ïpublic GrimoireOfTheDead(UUID ownerId) {°Ïsuper(ownerId, 226, "Grimoire of the Dead", Rarity.MYTHIC, new CardType[]{CardType.ARTIFACT}, "{4}");°Ïthis.expansionSetCode = "ISD";°Ïthis.supertype.add("Legendary");°ÏAbility ability1 = new SimpleActivatedAbility(Zone.BATTLEFIELD, new AddCountersSourceEffect(CounterType.STUDY.createInstance()), new ManaCostsImpl("{1}"));°Ïability1.addCost(new TapSourceCost());°Ïability1.addCost(new DiscardTargetCost(new TargetCardInHand()));°Ïthis.addAbility(ability1);°ÏAbility ability2 = new SimpleActivatedAbility(Zone.BATTLEFIELD, new GrimoireOfTheDeadEffect(), new TapSourceCost());°Ïability2.addCost(new RemoveCountersSourceCost(CounterType.STUDY.createInstance(3)));°Ïability2.addCost(new SacrificeSourceCost());°Ïthis.addAbility(ability2);°Ï}°Ïpublic GrimoireOfTheDead(final GrimoireOfTheDead card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic GrimoireOfTheDead copy() {°Ïreturn new GrimoireOfTheDead(this);°Ï}°Ï}°Ïclass GrimoireOfTheDeadEffect extends OneShotEffect {°Ïpublic GrimoireOfTheDeadEffect() {°Ïsuper(Outcome.PutCreatureInPlay);°ÏstaticText = "Put all creature cards in all graveyards onto the battlefield under your control. They're black Zombies in addition to their other colors and types";°Ï}°Ïpublic GrimoireOfTheDeadEffect(final GrimoireOfTheDeadEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°ÏPlayer controller = game.getPlayer(source.getControllerId());°Ïif (controller != null) {°ÏSet<Card> creatureCards = new LinkedHashSet<>();°Ïfor (Player player : game.getPlayers().values()) {°Ïfor (Card card : player.getGraveyard().getCards(game)) {°Ïif (card.getCardType().contains(CardType.CREATURE)) {°ÏcreatureCards.add(card);°Ïgame.addEffect(new GrimoireOfTheDeadEffect2(card.getId()), source);°Ï}°Ï}°Ï}°Ïcontroller.moveCards(creatureCards, Zone.BATTLEFIELD, source, game, false, false, false, null);°Ïreturn true;°Ï}°Ïreturn false;°Ï}°Ï@Override°Ïpublic GrimoireOfTheDeadEffect copy() {°Ïreturn new GrimoireOfTheDeadEffect(this);°Ï}°Ï}°Ïclass GrimoireOfTheDeadEffect2 extends ContinuousEffectImpl {°Ïprivate final UUID targetId;°Ïpublic GrimoireOfTheDeadEffect2(UUID targetId) {°Ïsuper(Duration.Custom, Outcome.Neutral);°Ïthis.targetId = targetId;°ÏstaticText = "Becomes a black Zombie in addition to its other colors and types";°Ï}°Ïpublic GrimoireOfTheDeadEffect2(final GrimoireOfTheDeadEffect2 effect) {°Ïsuper(effect);°Ïthis.targetId = effect.targetId;°Ï}°Ï@Override°Ïpublic GrimoireOfTheDeadEffect2 copy() {°Ïreturn new GrimoireOfTheDeadEffect2(this);°Ï}°Ï@Override°Ïpublic boolean apply(Layer layer, SubLayer sublayer, Ability source, Game game) {°ÏPermanent permanent = game.getPermanent(targetId);°Ïif (permanent != null) {°Ïswitch (layer) {°Ïcase ColorChangingEffects_5:°Ïif (sublayer == SubLayer.NA) {°Ïpermanent.getColor(game).setBlack(true);°Ï}°Ïbreak;°Ïcase TypeChangingEffects_4:°Ïif (sublayer == SubLayer.NA) {°Ïpermanent.getSubtype().add("Zombie");°Ï}°Ïbreak;°Ï}°Ïreturn true;°Ï}°Ïreturn false;°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°Ïreturn false;°Ï}°Ï@Override°Ïpublic boolean hasLayer(Layer layer) {°Ïreturn layer == Layer.ColorChangingEffects_5 || layer == Layer.TypeChangingEffects_4;°Ï}°Ï}°Ï
