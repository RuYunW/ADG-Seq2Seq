public class ImpromptuRaid extends CardImpl {°Ïpublic ImpromptuRaid(UUID ownerId) {°Ïsuper(ownerId, 209, "Impromptu Raid", Rarity.RARE, new CardType[]{CardType.ENCHANTMENT}, "{3}{R/G}");°Ïthis.expansionSetCode = "SHM";°Ïthis.addAbility(new SimpleActivatedAbility(Zone.BATTLEFIELD, new ImpromptuRaidEffect(), new ManaCostsImpl("{2}{R/G}")));°Ï}°Ïpublic ImpromptuRaid(final ImpromptuRaid card) {°Ïsuper(card);°Ï}°Ï@Override°Ïpublic ImpromptuRaid copy() {°Ïreturn new ImpromptuRaid(this);°Ï}°Ï}°Ïclass ImpromptuRaidEffect extends OneShotEffect {°Ïprivate static final FilterCard filterPutInGraveyard = new FilterCard("noncreature card to put into your graveyard");°Ïstatic {°ÏfilterPutInGraveyard.add(Predicates.not(new CardTypePredicate(CardType.CREATURE)));°Ï}°Ïpublic ImpromptuRaidEffect() {°Ïsuper(Outcome.DrawCard);°Ïthis.staticText = "Reveal the top card of your library. If it isn't a creature card, put it into your graveyard. Otherwise, put that card onto the battlefield. That creature gains haste. Sacrifice it at the beginning of the next end step";°Ï}°Ïpublic ImpromptuRaidEffect(final ImpromptuRaidEffect effect) {°Ïsuper(effect);°Ï}°Ï@Override°Ïpublic ImpromptuRaidEffect copy() {°Ïreturn new ImpromptuRaidEffect(this);°Ï}°Ï@Override°Ïpublic boolean apply(Game game, Ability source) {°ÏPlayer controller = game.getPlayer(source.getControllerId());°ÏMageObject sourceObject = game.getObject(source.getSourceId());°Ïif (sourceObject != null && controller != null) {°ÏCard card = controller.getLibrary().getFromTop(game);°ÏCards cards = new CardsImpl();°Ïif (card != null) {°Ïcards.add(card);°Ïcontroller.revealCards(sourceObject.getName(), cards, game);°Ïif (filterPutInGraveyard.match(card, source.getSourceId(), source.getControllerId(), game)) {°Ïcontroller.moveCards(card, Zone.LIBRARY, Zone.GRAVEYARD, source, game);°Ïreturn true;°Ï}°Ïif (controller.moveCards(card, Zone.BATTLEFIELD, source, game)) {°ÏPermanent permanent = game.getPermanent(card.getId());°Ïif (permanent != null) {°ÏContinuousEffect effect = new GainAbilityTargetEffect(HasteAbility.getInstance(), Duration.EndOfTurn);°Ïeffect.setTargetPointer(new FixedTarget(permanent, game));°Ïgame.addEffect(effect, source);°ÏSacrificeTargetEffect sacrificeEffect = new SacrificeTargetEffect("", source.getControllerId());°ÏsacrificeEffect.setTargetPointer(new FixedTarget(permanent, game));°ÏDelayedTriggeredAbility delayedAbility = new AtTheBeginOfNextEndStepDelayedTriggeredAbility(sacrificeEffect);°Ïgame.addDelayedTriggeredAbility(delayedAbility, source);°Ï}°Ïreturn true;°Ï}°Ï}°Ï}°Ïreturn false;°Ï}°Ï}°Ï
